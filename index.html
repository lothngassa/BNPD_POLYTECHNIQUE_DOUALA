<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BNPD - Biblioth√®que Num√©rique Polytechnique Douala</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* bg-slate-50 */
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card-animate {
            animation: fadeIn 0.5s ease-out forwards;
            opacity: 0;
        }
        /* D√©lai d'animation pour un effet escalier */
        .card-animate:nth-child(1) { animation-delay: 0.1s; }
        .card-animate:nth-child(2) { animation-delay: 0.15s; }
        .card-animate:nth-child(3) { animation-delay: 0.2s; }
        .card-animate:nth-child(4) { animation-delay: 0.25s; }
        .card-animate:nth-child(5) { animation-delay: 0.3s; }
        .card-animate:nth-child(6) { animation-delay: 0.35s; }
        .card-animate:nth-child(7) { animation-delay: 0.4s; }
        .card-animate:nth-child(8) { animation-delay: 0.45s; }
        .card-animate:nth-child(9) { animation-delay: 0.5s; }
        .card-animate:nth-child(10) { animation-delay: 0.55s; }
        .card-animate:nth-child(11) { animation-delay: 0.6s; }
        .card-animate:nth-child(12) { animation-delay: 0.65s; }

        .hidden { display: none; }

        /* Style pour le tag de filtre actif */
        .filter-tag.active-tag {
            background-color: #4f46e5; /* bg-indigo-600 */
            color: white;
            border-color: #4f46e5;
            font-weight: 600;
        }
    </style>
</head>
<body class="min-h-screen">

    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-60 z-20 hidden"></div>
    <nav id="sidebar" class="fixed top-0 left-0 w-80 h-full bg-white shadow-xl z-30 transform -translate-x-full transition-transform duration-300 ease-in-out flex flex-col">
        <div class="p-5 border-b">
            <h2 class="text-xl font-bold text-indigo-700">Fili√®res (ENSPD)</h2>
        </div>
        <div id="sidebar-links" class="flex flex-col p-4 space-y-2 flex-1 overflow-y-auto">
            <a href="#" data-filiere="GIT" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie Informatique et t√©l√©com (GIT)</a>
            <a href="#" data-filiere="GCI" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie Civil (GCI)</a>
            <a href="#" data-filiere="GPH" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie Physique (GPH)</a>
            <a href="#" data-filiere="GM" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie M√©canique (GM)</a>
            <a href="#" data-filiere="GE" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie √ânerg√©tique (GE)</a>
            <a href="#" data-filiere="GP" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie des Proc√©d√©s (GP)</a>
            <a href="#" data-filiere="GMP" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie Maritime et Portuaire (GMP)</a>
            <a href="#" data-filiere="GAM" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">G√©nie Automobile et M√©catronique (GAM)</a>
            <a href="#" data-filiere="QHSE" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">QHSE</a>
            <a href="#" data-filiere="MP" class="px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 font-medium">Master Professionnel (MP)</a>
        </div>
    </nav>

    <header class="bg-white shadow-md sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            
            <div class="flex items-center space-x-3">
                <button id="burger-btn" class="p-2 rounded-md text-gray-700 hover:bg-gray-100">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
                </button>
                <img src="logo.png" onerror="this.onerror=null;this.src='https://placehold.co/40x40/4f46e5/ffffff?text=Logo'" alt="Logo ENSPD" class="h-8 w-auto sm:h-10">
            </div>

            <h1 class="text-lg sm:text-xl font-bold text-indigo-700 text-center truncate flex-1">
                Biblioth√®que Num√©rique <span class="hidden sm:inline-block">Polytechnique Douala (BNPD)</span>
            </h1>

            <div class="flex items-center space-x-2 sm:space-x-4">
                <a href="PAGE SOUMISSION BIBLIOTHEQUE NUMERIQUE.html" class="bg-gradient-to-r from-indigo-600 to-blue-500 text-white px-3 sm:px-4 py-2 rounded-lg font-semibold hover:from-indigo-700 hover:to-blue-600 transition duration-300 shadow-lg shadow-indigo-400/50 flex items-center text-sm sm:text-base">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0.0 0.0 24.0 24.0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 mr-0 sm:mr-2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                    <span class="hidden sm:inline-block">T√©l√©verser</span>
                </a>
                <button class="p-2 rounded-full bg-gray-100 hover:bg-indigo-100 text-gray-600 transition duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0.0 0.0 24.0 24.0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
                        <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
        
        <section class="text-center mb-12">
            <h2 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-4 leading-snug">
                Bienvenue sur la plateforme des m√©moires
            </h2>
            <p class="text-lg text-gray-600 mb-8 max-w-2xl mx-auto">
                de l'Ecole Nationale Sup√©rieure Polytechnique de Douala
            </p>

            <div class="flex flex-col sm:flex-row items-stretch sm:items-center max-w-4xl mx-auto space-y-4 sm:space-y-0 sm:space-x-4">
                <div class="relative flex-grow shadow-xl rounded-xl">
                    <input type="text" id="search-input" placeholder="Rechercher par Th√®me, titre, nom de l'√©tudiant, Matricule..." 
                           class="w-full pl-12 pr-4 py-4 border-2 border-indigo-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 text-lg transition duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0.0 0.0 24.0 24.0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-gray-400 absolute left-4 top-1/2 transform -translate-y-1/2">
                        <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
                    </svg>
                </div>
                
                <div class="relative">
                    <button id="filter-toggle-btn" class="w-full sm:w-auto bg-white border-2 border-gray-300 text-gray-800 px-6 py-4 rounded-xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition duration-300 flex items-center justify-center text-lg whitespace-nowrap shadow-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0.0 0.0 24.0 24.0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2">
                            <path d="M3 6h18M7 12h10M10 18h4"/>
                        </svg>
                        Filtres
                    </button>
                    <div id="filter-dropdown" class="absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-xl shadow-lg p-5 z-10 hidden">
                        <div class="space-y-4">
                            <div>
                                <label for="filter-filiere" class="block text-sm font-medium text-gray-700 mb-1">Fili√®re</label>
                                <select id="filter-filiere" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="">Toutes les fili√®res</option>
                                    <option value="GIT">GIT</option>
                                    <option value="GCI">GCI</option>
                                    <option value="GPH">GPH</option>
                                    <option value="GM">GM</option>
                                    <option value="GE">GE</option>
                                    <option value="GP">GP</option>
                                    <option value="GMP">GMP</option>
                                    <option value="GAM">GAM</option>
                                    <option value="QHSE">QHSE</option>
                                    <option value="MP">MP</option>
                                </select>
                            </div>
                            <div>
                                <label for="filter-annee" class="block text-sm font-medium text-gray-700 mb-1">Ann√©e</label>
                                <select id="filter-annee" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="">Toutes les ann√©es</option>
                                    <option value="2026">2026</option>
                                    <option value="2025">2025</option>
                                    <option value="2024">2024</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                    <option value="2020">2020</option>
                                </select>
                            </div>
                            <div>
                                <label for="filter-matricule" class="block text-sm font-medium text-gray-700 mb-1">Matricule</label>
                                <input type="text" id="filter-matricule" placeholder="Ex: 21G..." class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <button id="apply-filter-btn" class="w-full bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition duration-300">
                                Appliquer les filtres
                            </button>
                        </div>
                    </div>
                </div>

                </div>
            
            <div id="quick-filters" class="mt-8 flex flex-wrap justify-center gap-3">
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GIT">#GIT</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GCI">#GCI</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GPH">#GPH</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GM">#GM</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GE">#GE</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GP">#GP</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GMP">#GMP</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="GAM">#GAM</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="QHSE">#QHSE</span>
                <span class="filter-tag bg-white text-indigo-700 border border-indigo-200 px-4 py-2 rounded-full cursor-pointer text-sm font-medium shadow-sm hover:border-indigo-400" data-filiere="MP">#MP</span>
            </div>
        </section>

        <section class="mt-12">
            <h3 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">
                M√©moires R√©cents (<span id="results-count">0</span>)
            </h3>

            <div id="card-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            </div>
            
            <div class="text-center mt-10">
                <button class="bg-indigo-50 border-2 border-indigo-200 text-indigo-700 px-8 py-3 rounded-xl font-semibold hover:bg-indigo-100 hover:shadow-lg transition duration-300 shadow-md">
                    Afficher plus de r√©sultats
                </button>
            </div>
        </section>

    </main>

    <script type="module">
        // --- √âl√©ments du DOM (UI) ---
        const burgerBtn = document.getElementById('burger-btn');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        const filterBtn = document.getElementById('filter-toggle-btn');
        const filterDropdown = document.getElementById('filter-dropdown');
        
        // --- √âl√©ments du DOM (Filtrage et Donn√©es) ---
        const cardGrid = document.getElementById('card-grid');
        const resultsCountSpan = document.getElementById('results-count');
        const searchInput = document.getElementById('search-input');
        const filiereDropdown = document.getElementById('filter-filiere');
        const anneeDropdown = document.getElementById('filter-annee');
        const matriculeInput = document.getElementById('filter-matricule');
        const applyFilterBtn = document.getElementById('apply-filter-btn');
        const quickFilterTags = document.querySelectorAll('#quick-filters .filter-tag');
        const sidebarLinks = document.querySelectorAll('#sidebar-links a[data-filiere]');

        // Stockage global des m√©moires charg√©s depuis l'API
        let allMemoires = [];
        
        // Mappage pour afficher le nom complet de la fili√®re
        const filiereMapping = {
            'GIT': 'G√©nie Informatique et t√©l√©com',
            'GCI': 'G√©nie Civil',
            'GPH': 'G√©nie Physique',
            'GM': 'G√©nie M√©canique',
            'GE': 'G√©nie √ânerg√©tique',
            'GP': 'G√©nie des Proc√©d√©s',
            'GMP': 'G√©nie Maritime et Portuaire',
            'GAM': 'G√©nie Automobile et M√©catronique',
            'QHSE': 'QHSE',
            'MP': 'Master Professionnel'
        };

        // Mappage de couleurs pour les badges de fili√®re
        const filiereColorMapping = {
            'GIT': { bg: 'bg-indigo-100', text: 'text-indigo-800' },
            'GCI': { bg: 'bg-green-100', text: 'text-green-800' },
            'GPH': { bg: 'bg-red-100', text: 'text-red-800' },
            'GM': { bg: 'bg-yellow-100', text: 'text-yellow-800' },
            'GE': { bg: 'bg-blue-100', text: 'text-blue-800' },
            'GP': { bg: 'bg-purple-100', text: 'text-purple-800' },
            'GMP': { bg: 'bg-pink-100', text: 'text-pink-800' },
            'GAM': { bg: 'bg-orange-100', text: 'text-orange-800' },
            'QHSE': { bg: 'bg-teal-100', text: 'text-teal-800' },
            'MP': { bg: 'bg-gray-100', text: 'text-gray-800' }
        };

        // --- Gestion de la Sidebar (Menu Burger) ---
        if (burgerBtn && sidebar && overlay) {
            burgerBtn.addEventListener('click', () => {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
            });
            overlay.addEventListener('click', () => {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
            });
        }

        // --- Gestion du Dropdown des Filtres ---
        if (filterBtn && filterDropdown) {
            filterBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                filterDropdown.classList.toggle('hidden');
            });
            document.addEventListener('click', (e) => {
                if (filterDropdown && !filterDropdown.classList.contains('hidden') && !filterDropdown.contains(e.target) && !filterBtn.contains(e.target)) {
                    filterDropdown.classList.add('hidden');
                }
            });
        }

        // ----------------------------------------------------
        // LOGIQUE DYNAMIQUE
        // ----------------------------------------------------

        /**
         * 1. Cr√©e le HTML pour une seule carte m√©moire
         */
        function createCardHTML(memoire) {
            // üí° AJUSTEMENT 1: Utilisation de l'adresse de production pour les PDFs
            const pdfUrl = `https://bn-polytechnique-douala-api.onrender.com${memoire.fichier_pdf}`;
            const fullFiliereName = filiereMapping[memoire.filiere] || memoire.filiere;
            
            // R√©cup√®re les classes de couleur ou utilise le gris par d√©faut
            const colors = filiereColorMapping[memoire.filiere] || { bg: 'bg-gray-100', text: 'text-gray-800' };

            // Ajustement pour l'Axe de Sp√©cialisation (Point 1)
            const axeHtml = memoire.axe_recherche 
                ? `<span class="block text-xs text-gray-500 mt-2 font-medium">AXE DE SP√âCIALISATION : ${memoire.axe_recherche}</span>` 
                : ''; 

            return `
                <div class="group card-animate bg-white p-5 rounded-xl shadow-lg border border-gray-100 hover:shadow-2xl hover:border-indigo-200 transition-all duration-300 transform hover:-translate-y-1 flex flex-col justify-between" 
                     data-filiere="${memoire.filiere}" 
                     data-annee="${memoire.annee}">
                    
                    <div>
                        <span class="text-xs font-semibold uppercase tracking-wider ${colors.text} ${colors.bg} px-3 py-1 rounded-full">${fullFiliereName}</span>
                        ${axeHtml}
                        
                        <a href="PAGE DETAIL BIBLIOTHEQUE NUMERIQUE.html?id=${memoire.id}" class="block hover:text-indigo-600 transition-colors">
                            <h4 class="text-lg font-bold text-gray-900 mt-2 mb-2 leading-snug">
                                ${memoire.titre}
                            </h4>
                        </a>
                        <p class="text-sm text-gray-500"><span class="font-medium text-gray-700">Auteur(s) :</span> ${memoire.auteur}</p>
                        <p class="text-sm text-gray-500"><span class="font-medium text-gray-700">Ann√©e :</span> ${memoire.annee}</p>
                    </div>
                    
                    <div class="mt-4 pt-4 border-t border-gray-100 flex justify-between items-center">
                        <span class="text-xs text-gray-500 font-bold">Publi√© le: ${new Date(memoire.date_soumission).toLocaleDateString('fr-FR')}</span>
                        
                        <a href="${pdfUrl}" target="_blank" rel="noopener noreferrer" class="text-indigo-600 group-hover:bg-indigo-600 group-hover:text-white rounded-full px-3 py-1 transition-all duration-300 font-semibold flex items-center text-sm">
                            T√©l√©charger
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0.0 0.0 24.0 24.0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 ml-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-3-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                        </a>
                    </div>
                </div>
            `;
        }

        /**
         * 2. Affiche les m√©moires filtr√©s dans la grille
         */
        function renderCards(memoiresToRender) {
            if (memoiresToRender.length === 0) {
                cardGrid.innerHTML = '<p class="text-center text-slate-500 py-10 col-span-full">Aucun m√©moire ne correspond √† vos crit√®res.</p>';
            } else {
                cardGrid.innerHTML = memoiresToRender.map(createCardHTML).join('');
            }
            resultsCountSpan.textContent = memoiresToRender.length;
        }

        /**
         * 3. Fonction de filtrage principale
         */
        function filterMemoires() {
            const searchTerm = searchInput.value.toLowerCase();
            const selectedFiliere = filiereDropdown.value;
            const selectedAnnee = anneeDropdown.value;
            const selectedMatricule = matriculeInput.value.toLowerCase(); 

            const filteredMemoires = allMemoires.filter(memoire => {
                const filiereMatch = (selectedFiliere === "" || memoire.filiere === selectedFiliere);
                const anneeMatch = (selectedAnnee === "" || memoire.annee.toString() === selectedAnnee);

                const textMatch = (
                    memoire.titre.toLowerCase().includes(searchTerm) ||
                    memoire.auteur.toLowerCase().includes(searchTerm) ||
                    (memoire.axe_recherche && memoire.axe_recherche.toLowerCase().includes(searchTerm))
                );
                
                const matriculeMatch = (selectedMatricule === "" || memoire.matricule.toLowerCase().includes(selectedMatricule));

                return filiereMatch && anneeMatch && textMatch && matriculeMatch;
            });

            renderCards(filteredMemoires);

            if (filterDropdown) filterDropdown.classList.add('hidden');
        }

        /**
         * 4. Charge les m√©moires depuis l'API au d√©marrage
         */
        async function loadMemoires() {
            cardGrid.innerHTML = '<p class="text-center text-slate-500 py-10 col-span-full">Chargement des m√©moires...</p>';
            resultsCountSpan.textContent = '...';

            try {
                // üí° AJUSTEMENT 3: Utilisation de l'adresse de production pour l'API
                const response = await fetch('https://bn-polytechnique-douala-api.onrender.com/api/memoires/');
                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }
                const data = await response.json();

                allMemoires = data; 
                renderCards(allMemoires); 

            } catch (error) {
                console.error("Erreur de chargement des m√©moires:", error);
                cardGrid.innerHTML = '<p class="text-center text-red-500 py-10 col-span-full">√âchec du chargement. V√©rifiez votre connexion et l\'adresse de l\'API.</p>';
                resultsCountSpan.textContent = 0;
            }
        }

        // ----------------------------------------------------
        // ATTACHE DES √âCOUTEURS D'√âV√âNEMENTS
        // ----------------------------------------------------

        document.addEventListener('DOMContentLoaded', () => {
            loadMemoires(); 
            searchInput.addEventListener('input', filterMemoires);
            applyFilterBtn.addEventListener('click', filterMemoires);
            
            quickFilterTags.forEach(tag => {
                tag.addEventListener('click', () => {
                    const filiere = tag.dataset.filiere;

                    if (tag.classList.contains('active-tag')) {
                        tag.classList.remove('active-tag');
                        filiereDropdown.value = ""; 
                    } else {
                        quickFilterTags.forEach(t => t.classList.remove('active-tag'));
                        tag.classList.add('active-tag');
                        filiereDropdown.value = filiere; 
                    }
                    filterMemoires(); 
                });
            });

            sidebarLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault(); 
                    const filiere = e.currentTarget.dataset.filiere;

                    filiereDropdown.value = filiere;

                    quickFilterTags.forEach(t => t.classList.remove('active-tag'));
                    const activeTag = document.querySelector(`.filter-tag[data-filiere="${filiere}"]`);
                    if (activeTag) activeTag.classList.add('active-tag');

                    filterMemoires();

                    sidebar.classList.add('-translate-x-full');
                    overlay.classList.add('hidden');
                });
            });
        });

    </script>
</body>
</html>